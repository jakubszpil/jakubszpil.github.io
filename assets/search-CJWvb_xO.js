import{r as c,j as e,h as o,k as d,e as h,F as f,f as m}from"./index-Dj7ygcOB.js";import{b as p,d as w,B as y}from"./button-CscWyoNn.js";import{f as j}from"./fetch-DCcDgW2Z.js";import{A as x}from"./articles-GBDEDB8o.js";import{C as g}from"./courses-mkYSX7P0.js";import{I as k}from"./IconSearch-CKJDhT0y.js";import"./link-with-prefetch-BNEX4AUn.js";import"./date-BfXueLdd.js";const l=c.forwardRef(({className:s,type:r,...t},a)=>e.jsx("input",{type:r,className:p("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...t}));l.displayName="Input";const b=s=>{try{return new URL(s),!0}catch{return!1}};async function z(s,r){const t=await j("/content/search.json",{cache:"force-cache",signal:s.signal}),a=i=>r?JSON.stringify(i).toLowerCase().includes(r.toLowerCase()):!1,n=await t.json();return Object.fromEntries(Object.entries(n).map(([i,u])=>[i,u.filter(a)]))}async function S(s){return Object.values(s).reduce((r,{length:t})=>r+t,0)}async function R(s){const r=new URL(s.url),t=r.searchParams.get("q");if(t){if(t==="")throw r.searchParams.delete("q"),o(r.toString());const a=t.trim().split(" ").filter(Boolean).join(" ");if(t!==a)throw a?r.searchParams.set("q",a):r.searchParams.delete("q"),o(r.toString())}if(t&&b(t)){const a=new URL(s.url),n=new URL(t);if(a.origin===n.origin)throw o(d(n).replace("#/",""))}return t}async function O({request:s}){const r=await R(s),t=await z(s,r),a=await S(t);return m({...t,query:r,resultsCount:a})}function A(){const{query:s,articles:r,courses:t,resultsCount:a}=h(),n=c.useCallback(()=>{if(!s)return null;if(a===0)return e.jsxs("h2",{children:["Brak wyników wyszukiwania dla zapytania: ",s]});const i={pathname:`/search?q=${s}`,label:"Powrót do wyników wyszukiwania"};return e.jsxs(e.Fragment,{children:[e.jsxs("h2",{children:["Wyniki wyszukiwania (",a,")"]}),r.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{children:["Artykuły (",r.length,")"]}),e.jsx(x,{className:"px-0 !grid-cols-1",articles:r,locationState:i})]}),t.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{children:["Kursy (",t.length,")"]}),e.jsx(g,{className:"px-0 !grid-cols-1",courses:t,locationState:i})]})]})},[r,t,s,a]);return e.jsxs("section",{className:"prose max-w-full",children:[e.jsx(w,{title:s?`(${a}) Rezultaty wyszukiwania dla ${s}`:"Szukaj"}),e.jsxs("header",{className:"container pb-0",children:[e.jsx("h1",{className:"mb-0",children:"Szukaj"}),e.jsx("p",{children:"Wskazówka: Obszary po których możesz szukać:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Artykuły: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),e.jsx("li",{children:"Kursy: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),e.jsx("li",{children:"Projekty: (tytuł, opis, słowa klucz, technologie, zawartość)"})]}),e.jsx("p",{children:"Możesz też wkleić skopiowany link aby spróbować przejść do wskazanej strony"})]}),e.jsxs(f,{preventScrollReset:!0,method:"get",className:"container py-0 bg-background flex gap-2",children:[e.jsx(l,{type:"text",name:"q",placeholder:"Treść zapytania",defaultValue:s??"",required:!0},s),e.jsxs(y,{type:"submit",children:[e.jsx(k,{className:"h-5 w-5 mr-1"}),"Szukaj"]})]}),e.jsx("div",{className:"container pt-0",children:n()})]})}export{A as default,O as loader};
