import{j as e,f as o,h as u,e as d,r as h,F as f}from"./index-2eX3B2If.js";import{a as m,B as p}from"./button-2m-kfoVf.js";import{S as w}from"./seo-CZIgU4kj.js";import{f as x}from"./fetch-Ckex8saM.js";import{A as y}from"./articles-Dv4SWfRB.js";import{C as j}from"./courses-OYrSetbv.js";import{I as g}from"./IconSearch-tuZ8WV7a.js";import"./link-with-prefetch-DQZ9kWKd.js";import"./date-BfXueLdd.js";const l=({className:s,type:r,ref:t,...a})=>e.jsx("input",{type:r,className:m("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a});l.displayName="Input";const k=s=>{try{return new URL(s),!0}catch{return!1}};async function b(s,r){const t=await x("/content/search.json",{cache:"force-cache",signal:s.signal}),a=i=>r?JSON.stringify(i).toLowerCase().includes(r.toLowerCase()):!1,n=await t.json();return Object.fromEntries(Object.entries(n).map(([i,c])=>[i,c.filter(a)]))}async function z(s){return Object.values(s).reduce((r,{length:t})=>r+t,0)}async function S(s){const r=new URL(s.url),t=r.searchParams.get("q");if(t){if(t==="")throw r.searchParams.delete("q"),o(r.toString());const a=t.trim().split(" ").filter(Boolean).join(" ");if(t!==a)throw a?r.searchParams.set("q",a):r.searchParams.delete("q"),o(r.toString())}if(t&&k(t)){const a=new URL(s.url),n=new URL(t);if(a.origin===n.origin)throw o(u(n).replace("#/",""))}return t}async function O({request:s}){const r=await S(s),t=await b(s,r),a=await z(t);return{...t,query:r,resultsCount:a}}function A(){const{query:s,articles:r,courses:t,resultsCount:a}=d(),n=h.useCallback(()=>{if(!s)return null;if(a===0)return e.jsxs("h2",{children:["Brak wyników wyszukiwania dla zapytania: ",s]});const i={pathname:`/search?q=${s}`,label:"Powrót do wyników wyszukiwania"};return e.jsxs(e.Fragment,{children:[e.jsxs("h2",{children:["Wyniki wyszukiwania (",a,")"]}),r.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{children:["Artykuły (",r.length,")"]}),e.jsx(y,{className:"px-0 !grid-cols-1",articles:r,locationState:i,prefix:"/blog"})]}),t.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{children:["Kursy (",t.length,")"]}),e.jsx(j,{className:"px-0 !grid-cols-1",courses:t,locationState:i,prefix:"/learning"})]})]})},[r,t,s,a]);return e.jsxs("section",{className:"prose max-w-full",children:[e.jsx(w,{title:s?`(${a}) Rezultaty wyszukiwania dla ${s}`:"Szukaj"}),e.jsxs("header",{className:"container pb-0",children:[e.jsx("h1",{className:"mb-0",children:"Szukaj"}),e.jsx("p",{children:"Wskazówka: Obszary po których możesz szukać:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Artykuły: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),e.jsx("li",{children:"Kursy: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),e.jsx("li",{children:"Projekty: (tytuł, opis, słowa klucz, technologie, zawartość)"})]}),e.jsx("p",{children:"Możesz też wkleić skopiowany link aby spróbować przejść do wskazanej strony"})]}),e.jsxs(f,{preventScrollReset:!0,method:"get",className:"container py-0 bg-background flex gap-2",children:[e.jsx(l,{type:"text",name:"q",placeholder:"Treść zapytania",defaultValue:s??"",required:!0},s),e.jsxs(p,{type:"submit",children:[e.jsx(g,{className:"h-5 w-5 mr-1"}),"Szukaj"]})]}),e.jsx("div",{className:"container pt-0",children:n()})]})}export{A as default,O as loader};
