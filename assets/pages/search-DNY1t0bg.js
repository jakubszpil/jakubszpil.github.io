import{r as o,j as s}from"../react-vvBGimMH.js";import{r as i,c as l,F as u}from"../routing-CDreLu1L.js";import{A as h,d,S as j,I as m,B as p}from"../components-CxpGlKlM.js";import{f as y,i as w,d as x,j as f}from"../utils-46OwyQtw.js";import{p as k}from"../runtime-Fe8qnWBl.js";async function g(a,r){const e=await y("/content/search.json",{cache:"force-cache",signal:a.signal}),t=c=>r?JSON.stringify(c).toLowerCase().includes(r.toLowerCase()):!1,n=await e.json();return{articles:n.articles.filter(t),courses:n.courses.filter(t)}}async function z(a){const r=new URL(a.url),e=r.searchParams.get("q");if(e){if(e==="")throw r.searchParams.delete("q"),i(r.toString());const t=e.trim().split(" ").filter(Boolean).join(" ");if(e!==t)throw t?r.searchParams.set("q",t):r.searchParams.delete("q"),i(r.toString())}if(e&&w(e)){const t=new URL(a.url),n=new URL(e);if(t.origin===n.origin)throw i(l(n).replace("#/",""))}return e}async function C({request:a}){const r=await z(a),e=await g(a,r),t=e.articles.length+e.courses.length;return f({query:r,articles:e.articles,courses:e.courses,resultsCount:t})}function L(){const{query:a,articles:r,courses:e,resultsCount:t}=x(),n=o.useCallback(()=>a?t===0?s.jsxs("h2",{children:["Brak wyników wyszukiwania dla zapytania: ",a]}):s.jsxs(s.Fragment,{children:[s.jsxs("h2",{children:["Wyniki wyszukiwania (",t,")"]}),r.length>0&&s.jsxs("section",{children:[s.jsxs("h3",{children:["Artykuły (",r.length,")"]}),s.jsx(h,{className:"px-0 !grid-cols-1",articles:r})]}),e.length>0&&s.jsxs("section",{children:[s.jsxs("h3",{children:["Kursy (",e.length,")"]}),s.jsx(d,{className:"px-0 !grid-cols-1",courses:e})]})]}):null,[r,e,a,t]);return s.jsxs("section",{className:"prose max-w-full",children:[s.jsx(j,{title:a?`(${t}) Rezultaty wyszukiwania dla ${a}`:"Szukaj"}),s.jsxs("header",{className:"container pb-0",children:[s.jsx("h1",{className:"mb-0",children:"Szukaj"}),s.jsx("p",{children:"Wskazówka: Obszary po których możesz szukać:"}),s.jsxs("ul",{children:[s.jsx("li",{children:"Artykuły: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),s.jsx("li",{children:"Kursy: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),s.jsx("li",{children:"Projekty: (tytuł, opis, słowa klucz, technologie, zawartość)"})]}),s.jsx("p",{children:"Możesz też wkleić skopiowany link aby spróbować przejść do wskazanej strony"})]}),s.jsxs(u,{preventScrollReset:!0,method:"get",className:"container py-0 bg-background flex gap-2",children:[s.jsx(m,{type:"text",name:"q",placeholder:"Treść zapytania",defaultValue:a??"",required:!0},a),s.jsxs(p,{type:"submit",children:[s.jsx(k,{className:"h-5 w-5 mr-1"}),"Szukaj"]})]}),s.jsx("div",{className:"container pt-0",children:n()})]})}export{L as default,C as loader};
