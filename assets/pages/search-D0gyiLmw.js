import{r as l,j as e}from"../react-vvBGimMH.js";import{r as c,c as u,F as h}from"../routing-CDreLu1L.js";import{A as d,d as j,S as m,I as p,B as y}from"../components-C0_Cz5Q0.js";import{f as w,i as x,d as f,j as k}from"../utils-BcD-Ro5x.js";import{q as g}from"../runtime-BVelM1Lx.js";async function z(a,r){const s=await w("/content/search.json",{cache:"force-cache",signal:a.signal}),t=i=>r?JSON.stringify(i).toLowerCase().includes(r.toLowerCase()):!1,n=await s.json();return Object.fromEntries(Object.entries(n).map(([i,o])=>[i,o.filter(t)]))}async function S(a){return Object.values(a).reduce((r,{length:s})=>r+s,0)}async function b(a){const r=new URL(a.url),s=r.searchParams.get("q");if(s){if(s==="")throw r.searchParams.delete("q"),c(r.toString());const t=s.trim().split(" ").filter(Boolean).join(" ");if(s!==t)throw t?r.searchParams.set("q",t):r.searchParams.delete("q"),c(r.toString())}if(s&&x(s)){const t=new URL(a.url),n=new URL(s);if(t.origin===n.origin)throw c(u(n).replace("#/",""))}return s}async function P({request:a}){const r=await b(a),s=await z(a,r),t=await S(s);return k({...s,query:r,resultsCount:t})}function O(){const{query:a,articles:r,courses:s,resultsCount:t}=f(),n=l.useCallback(()=>a?t===0?e.jsxs("h2",{children:["Brak wyników wyszukiwania dla zapytania: ",a]}):e.jsxs(e.Fragment,{children:[e.jsxs("h2",{children:["Wyniki wyszukiwania (",t,")"]}),r.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{children:["Artykuły (",r.length,")"]}),e.jsx(d,{className:"px-0 !grid-cols-1",articles:r})]}),s.length>0&&e.jsxs("section",{children:[e.jsxs("h3",{children:["Kursy (",s.length,")"]}),e.jsx(j,{className:"px-0 !grid-cols-1",courses:s})]})]}):null,[r,s,a,t]);return e.jsxs("section",{className:"prose max-w-full",children:[e.jsx(m,{title:a?`(${t}) Rezultaty wyszukiwania dla ${a}`:"Szukaj"}),e.jsxs("header",{className:"container pb-0",children:[e.jsx("h1",{className:"mb-0",children:"Szukaj"}),e.jsx("p",{children:"Wskazówka: Obszary po których możesz szukać:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Artykuły: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),e.jsx("li",{children:"Kursy: (tytuł, opis, słowa klucz, kategorie, zawartość)"}),e.jsx("li",{children:"Projekty: (tytuł, opis, słowa klucz, technologie, zawartość)"})]}),e.jsx("p",{children:"Możesz też wkleić skopiowany link aby spróbować przejść do wskazanej strony"})]}),e.jsxs(h,{preventScrollReset:!0,method:"get",className:"container py-0 bg-background flex gap-2",children:[e.jsx(p,{type:"text",name:"q",placeholder:"Treść zapytania",defaultValue:a??"",required:!0},a),e.jsxs(y,{type:"submit",children:[e.jsx(g,{className:"h-5 w-5 mr-1"}),"Szukaj"]})]}),e.jsx("div",{className:"container pt-0",children:n()})]})}export{O as default,P as loader};
