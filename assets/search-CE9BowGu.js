var g=Object.defineProperty;var p=(s,t,e)=>t in s?g(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>p(s,typeof t!="symbol"?t+"":t,e);import{D as l,E as d}from"./chunk-GNGMS2XR-C5oA2J7v.js";const w=s=>{try{return new URL(s),!0}catch{return!1}},c="query",m=new Map;function I(s,t){if(t&&m.has(t))return m.get(t);const e=n=>t?JSON.stringify(n).toLowerCase().includes(t.toLowerCase()):!1,r=Object.fromEntries(Object.entries(s).map(([n,a])=>[n,a.filter(e)]));return t&&m.set(t,r),r}function L(s){return Object.values(s).reduce((t,{length:e})=>t+e,0)}function R(s){const t=new URL(s),e=t.searchParams.get(c);if(e){if(e==="")throw t.searchParams.delete(c),l(t.toString());const r=e.trim().split(" ").filter(Boolean).join(" ");if(e!==r)throw r?t.searchParams.set(c,r):t.searchParams.delete(c),l(t.toString())}if(e&&w(e)){const r=new URL(s),n=new URL(e);if(r.origin===n.origin)throw l(d(n))}return e}const u=class u{constructor(){i(this,"timestamp",1743187190750);i(this,"storage",localStorage)}setItem(t,e){return this.storage.setItem(t,JSON.stringify({timestamp:this.timestamp,value:e}))}getItem(t){const e=this.storage.getItem(t);if(!e)return null;const r=JSON.parse(e);return!r||r.timestamp!==this.timestamp?null:r.value}static getInstance(){return this.instance||(this.instance=new u),this.instance}};i(u,"instance");let o=u;async function S(s,t){const r=new URL(s).pathname.split("/").filter(Boolean).join(".index.")||"index",n=o.getInstance().getItem(r);if(n!==null)return n;const a=await t();return o.getInstance().setItem(r,a),a}async function y({request:s,serverLoader:t}){const e=S(s.url,t),r=R(s.url);return{results:e.then(a=>{const h=I(a,r),f=L(h);return{...h,count:f}}),query:r}}y.hydrate=!0;export{y as c,c as q};
